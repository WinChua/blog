import socket
srv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
srv.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEPORT, 1)
srv.bind(("localhost", 12345))
srv.listen(5)
cli, addr = srv.accept()
data = cli.recv(4096)
server_hello = b'\x16\x03\x03\x001\x02\x00\x00-\x03\x03pqrstuvwxyz{|}~\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x00\xc0\x13\x00\x00\x05\xff\x01\x00\x01\x00'
server_cert = b'0\x82\x03!0\x82\x02\t\xa0\x03\x02\x01\x02\x02\x08\x15Z\x92\xad\xc2\x04\x8f\x900\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000"1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x130\x11\x06\x03U\x04\n\x13\nExample CA0\x1e\x17\r181005013817Z\x17\r191005013817Z0+1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x1c0\x1a\x06\x03U\x04\x03\x13\x13example.ulfheim.net0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xc4\x806\x06\xba\xe7Gk\x08\x94\x04\xec\xa7\xb6\x91\x04?\xf7\x92\xbc\x19\xee\xfb}t\xd7\xa8\r\x00\x1e{K:J\xe6\x0f\xe8\xc0q\xfcs\xe7\x02L\r\xbc\xf4\xbd\xd1\x1d9k\xbapFJ\x13\xe9J\xf8=\xf3\xe1\tYT{\xc9U\xfbA-\xa3vR\x11\xe1\xf3\xdcwl\xaaS7n\xca:\xec\xbe\xc3\xaa\xb7;1\xd5l\xb6R\x9c\x80\x98\xbc\xc9\xe0(\x18\xe2\x0b\xf7\xf8\xa0:\xfd\x17\x04P\x9e\xcey\xbd\x9f9\xf1\xeai\xecG\x97.\x83\x0f\xb5\xca\x95\xde\x95\xa1\xe6\x04"\xd5\xee\xbeRyT\xa1\xe7\xbf\x8a\x86\xf6Fm\r\x9f\x16\x95\x1aL\xf7\xa0F\x92Y\\\x13R\xf2T\x9eZ\xfbN\xbf\xd7z7\x95\x01D\xe4\xc0&\x87Le>@}}#\x07D\x01\xf4\x84\xff\xd0\x8fz\x1f\xa0R\x10\xd1\xf4\xf0\xd5\xceyp)2\xe2\xca\xbep\x1f\xdf\xadkK\xb7\x11\x01\xf4K\xadfj\x11\x13\x0f\xe2\xee\x82\x9eM\x02\x9d\xc9\x1c\xddg\x16\xdb\xb9\x06\x18\x86\xed\xc1\xba\x94!\x02\x03\x01\x00\x01\xa3R0P0\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x05\xa00\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x02\x06\x08+\x06\x01\x05\x05\x07\x03\x010\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14\x89O\xde[\xcci\xe2R\xcf>\xa3\x00\xdf\xb1\x97\xb8\x1d\xe1\xc1F0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00Y\x16E\xa6\x9a.7y\xe4\xf6\xdd\'\x1a\xba\x1c\x0b\xfdl\xd7U\x99\xb5\xe7\xc3nS>\xff6Y\x08C$\xc9\xe7\xa5\x04\x07\x9d9\xe0\xd4)\x87\xff\xe3\xeb\xdd\t\xc1\xcf\x1d\x91DU\x87\x0bW\x1d\xd1\x9b\xdf\x1d$\xf8\xbb\x9a\x11\xfe\x80\xfdY+\xa09\x8c\xde\x11\xe2e\x1ea\x8c\xe5\x98\xfa\x96\xe57.\xef=$\x8a\xfd\xe1tc\xeb\xbf\xab\xb8\xe4\xd1\xabP*T\xec\x00d\xe9/x\x19f\r?\'\xcf \x9ef\x7f\xceZ\xe2\xe4\xac\x99\xc7\xc98\x18\xf8\xb2Q\x07"\xdf\xed\x97\xf3.>\x93I\xd4\xc6l\x9e\xa69mtDb\xa0kB\xc6\xd5\xbah\x8e\xac:\x01{\xdd\xfc\x8e,\xfc\xad\'\xcbi\xd3\xcc\xdc\xa2\x80ADe\xd3\xae4\x8c\xe0\xf3J\xb2\xfb\x9ca\x83q1+\x19\x10Ad\x1c#\x7f\x11\xa5\xd6\\\x84O\x04\x04\x84\x998q+\x95\x9e\xd6\x85\xbc\\]\xd6E\xed\x19\x90\x94s@)&\xdc\xb4\x0e4i\xa1YA\xe8\xe2\xcc\xa8K\xb6\x08F6\xa0'
cli.send(server_hello)
cli.send(server_cert)
sdata = cli.recv(4096)
with open("https_client_hello.bin", "wb") as f:
    f.write(data)


